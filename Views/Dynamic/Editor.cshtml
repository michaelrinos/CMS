
@{
    ViewData["Title"] = "Editor";
}

<h2>Editor</h2>


<style>
    body {
        margin: 0;
    }

    textarea {
        width: 100%;
        min-height: 100px;
        border: 1px solid #CCC;
        box-sizing: border-box;
        padding: 0 0 0 30px;
        resize: vertical;
        line-height: 16px;
        font-size: 13px;
        color: black;
    }

    iframe {
        bottom: 0;
        position: relative;
        width: 100%;
        height: 35em;
    }
</style>
<html>

<head>
    <title>Code Editor</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="stylesheet" asp-href-include="/lib/codemirror/codemirror.css" />
    <link href="~/lib/codemirror/theme/3024-night.css" rel="stylesheet" />
</head>

<body>



    <div class="container">
        <h1>Bootstrap tab panel example (using nav-pills) </h1>
        <div class="row">
            <div class="col-xs-12">

            </div>

        </div>

    </div>
    <div id="exTab1" class="container">
        <ul class="nav nav-pills">
            <li class="active">


                <a href="#1a" data-toggle="tab">HTML</a>
            </li>
            <li>
                <a href="#2a" data-toggle="tab">CSS</a>
            </li>
            <li>
                <a href="#3a" data-toggle="tab">JavaScript</a>
            </li>

        </ul>

        <div class="tab-content clearfix">
            <div class="tab-pane active" id="1a">
                <h1> This is html</h1>
                <textarea class="" id="html" placeholder="HTML"></textarea>
            </div>
            <div class="tab-pane" id="2a">
                <h1> CSS</h1>
                <textarea id="css" placeholder="CSS"></textarea>
            </div>
            <div class="tab-pane" id="3a">
                <h1> JavaScript </h1>
                <textarea id="js" placeholder="JavaScript"></textarea>
            </div>
        </div>
    </div>

    <hr>
    <hr>
    <iframe id="code"></iframe>

</body>

</html>
<script src="~/lib/codemirror/codemirror.js"></script>
<script>

    var editorHTML = CodeMirror.fromTextArea(document.getElementById("html"), {
        mode: "xml",
        htmlMode: true,
        lineNumbers: true,
        matchBrackets: true,
        value: "<h1> Welcome </h1>",
        theme: "3024-night"
    });
    /*
    var editorCSS = CodeMirror.fromTextArea($('#css')[0], {
        mode: "text/css",
        lineNumbers: true,
        matchBrackets: true,
        theme: "3024-night"
    });

    var editorJavaScript = CodeMirror.fromTextArea($("#js")[0], {
        mode: "text/javascript",
        lineNumbers: true,
        matchBrackets: true,
        theme: "3024-night"
    });
    // */
    editorHTML.on("keyup", documentChanges);
    //editorCSS.on("change", documentChanges());
    //editorJavaScript.on("change", documentChanges());
    $(document).ready(function () {
        $("#code").on("load", function() {
            var head = $("#code").contents().find("head");
            var jquery = '<link href="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js">'
            var bootstrapcss = '<link href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">'
            var bootstrapjs = '<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"><\/script>'


          $(head).append(jquery);
          $(head).append(bootstrapcss);
          $(head).append(bootstrapjs);
        });
    });

    function documentChanges() {

        var html = editorHTML.getValue();

        //var css = editorCSS.getValue();
        //var js = editorJavaScript.getValue();
        if (html) {
            var code = document.getElementById("code").contentWindow.document;
            code.open();
            code.writeln(html);


            //code.writeln(html.value + "<style>" + css.value + "</style>" + "<script>" + js.value + "<//script>");
            code.close();
        }
    };

</script>
